# cve-analyser
A tool to analyse the list of detected CVEs in the containers (usually created by static security scanner) and compare them to the Red Hat Security Data. 
The cve-analyser can find fixes in the rpm packages used in the specified container, as well as the fixes in the non-rpm content (like nodejs libraries). 

It is possible to specify a keyword as a affected component (instead of container name).  
Then the cve-analyser will show all Red Hat products where component/package name contain a specified word in the CVE affected products list.  

## Usage
To use this tool just run:  
`cve-analyser PATH_TO_THE_.csv_FILE`  
like:  
`cve-analyser test/test_golang_cve.csv`  

As an output you will get details about the specified in the .cvs file CVE and container image or package (see more details about cve file format in the next section) impact.  
There will be information about the Red Hat Severity and fix status for the specific image/package.  

The cve-analyser can cover rpm fixes and non-rpm content fixes (tech-preview feature) in the Red Hat products.  

## As a parameter it requires a csv file with two arguments in each line:
- CVE  
- Red Hat container image information  or Package name


Like:  
`CVE-2021-33503,ubi8/ubi:8.4-211`  

The Red Hat container image name must be provided in format visible also in the Red Hat Container Catalog page (https://catalog.redhat.com/software/containers/search?p=1) where first is specified the repository name, then after the "/" is the container name and after ":" is the image version.  

or

`CVE-2021-23337,kibana`

The as a second parameter is provided a package name, cve-analyser will search for any results for a specified name, it means that if there is a container with a name similar to the specified name, such container will be also displayed in the findings output.  
For example, if in the input will contains lines like below:  
```
CVE-2021-23337,openshift4/ose-logging-kibana6:v4.6.0-202109071652.p0.git.d578b18.assembly.stream
CVE-2021-23337,kibana
```
The output from the cve-analyser for each line will be:  
```
CVE-2021-23337 | openshift4/ose-logging-kibana6:v4.6.0-202109071652.p0.git.d578b18.assembly.stream | Moderate | (Red Hat OpenShift Container Platform 4,Will not fix,openshift4/ose-logging-kibana6)
CVE-2021-23337 | kibana | Moderate | (Red Hat OpenShift Container Platform 3.11,Will not fix,kibana)(Red Hat OpenShift Container Platform 4,Will not fix,kibana)(Red Hat OpenShift Container Platform 4,Will not fix,openshift4/ose-logging-kibana6)
```
The image openshift4/ose-logging-kibana6 is displayed twice. Once as a result for the exact container searching, second time as a name what contains `kibana` word.  


The second notation is useful when you want to find any products and their container images or packages with a specific name as a affected component.  
By default it's recommended to use first notation, with the exact container name as a component. That will show more accurate results.  